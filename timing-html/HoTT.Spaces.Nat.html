<html>
<head>
<title>Nat.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Nat.v</h1>

<div class="code" title="File: Nat.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)
(** * Theorems about the natural numbers, depending on TruncType *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 3
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>Require Export Coq.Init.Peano.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 3
Time: 0.017s">
<div class="time" style="width: 11.409395973154%"></div>
<pre>
Require Import HoTT.Basics.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 4
Time: 0.014s">
<div class="time" style="width: 9.3959731543624%"></div>
<pre>
Require Import HoTT.Types.Bool.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 5
Time: 0.149s">
<div class="time" style="width: 100%"></div>
<pre>
Require Import HoTT.TruncType HoTT.DProp.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We reopen these scopes so they take precedence over nat_scope; otherwise, now that we have [Coq.Init.Peano], we'd get [* : nat -&gt; nat -&gt; nat] rather than [* : Type -&gt; Type -&gt; Type]. *)</pre>
</div>
<div class="code" title="File: Nat.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Open Scope type_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Global Open Scope core_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** But in this file, we want to be able to use the usual symbols for natural number arithmetic. *)</pre>
</div>
<div class="code" title="File: Nat.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Scheme nat_ind := Induction for nat Sort Type.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Scheme nat_rec := Minimality for nat Sort Type.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Arithmetic *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma nat_plus_n_O : forall n:nat, n = n + 0.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl; apply ap; assumption.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma nat_plus_n_Sm : forall n m:nat, (n + m).+1 = n + m.+1.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros n m; induction n; simpl.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap; assumption.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 28
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition nat_plus_comm (n m : nat) : n + m = m + n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert m; induction n as [|n IH]; intros m; simpl.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (nat_plus_n_O m).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 35
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre> transitivity (m + n).+1.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Nat.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, IH.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Nat.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply nat_plus_n_Sm.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 37
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Exponentiation *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint nat_exp (n m : nat) : nat
  := match m with
       | 0 =&gt; 1
       | S m =&gt; nat_exp n m * n
     end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Factorials *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint factorial (n : nat) : nat
  := match n with
       | 0 =&gt; 1
       | S n =&gt; S n * factorial n
     end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* here ends the old Types/Nat.v and starts Spaces.v *)

(** Much of the layout of this file is adapted from ssreflect *)

(** ** Equality *)
(** *** Boolean equality and its properties *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint code_nat (m n : nat) {struct m} : DHProp :=
  match m, n with
    | 0, 0 =&gt; True
    | m'.+1, n'.+1 =&gt; code_nat m' n'
    | _, _ =&gt; False
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "=n" := code_nat (at level 70, no associativity) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 67
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>

Fixpoint idcode_nat {n} : (n =n n) :=
  match n as n return (n =n n) with
    | 0 =&gt; tt
    | S n' =&gt; @idcode_nat n'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 73
Time: 0.004s">
<div class="time" style="width: 2.6845637583893%"></div>
<pre>

Fixpoint path_nat {n m} : (n =n m) -&gt; (n = m) :=
  match m as m, n as n return (n =n m) -&gt; (n = m) with
    | 0, 0 =&gt; fun _ =&gt; idpath
    | m'.+1, n'.+1 =&gt; fun H : (n' =n m') =&gt; ap S (path_nat H)
    | _, _ =&gt; fun H =&gt; match H with end
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance isequiv_path_nat {n m} : IsEquiv (@path_nat n m).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 83
Time: 0.003s">
<div class="time" style="width: 2.0134228187919%"></div>
<pre>
  refine (isequiv_adjointify
            (@path_nat n m)
            (fun H =&gt; transport (fun m' =&gt; (n =n m')) H idcode_nat)
            _ _).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Nat.v
Line: 88
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre> intros []; simpl.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 88
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>
    induction n; simpl; trivial.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 89
Time: 0.002s">
<div class="time" style="width: 1.3422818791946%"></div>
<pre>
    by destruct (IHn^)%path.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Nat.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Nat.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 91
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre> apply path_ishprop.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Nat.v
Line: 91
Time: 0.003s">
<div class="time" style="width: 2.0134228187919%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 92
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>

Definition equiv_path_nat {n m} : (n =n m) &lt;~&gt; (n = m)
  := BuildEquiv _ _ (@path_nat n m) _.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 95
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>

Global Instance decidable_paths_nat : DecidablePaths nat
  := fun n m =&gt; decidable_equiv _ (@path_nat n m) _.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Corollary hset_nat : IsHSet nat.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 101
Time: 0.01s">
<div class="time" style="width: 6.7114093959732%"></div>
<pre>
  exact _.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Natural number ordering *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition leq m n := ((m - n) =n 0).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Notation "m &lt;= n" := (leq m n) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "m &lt; n" := (m.+1 &lt;= n) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "m &gt;= n" := (n &lt;= m) (only parsing) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "m &gt; n" := (n &lt; m) (only parsing) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Theorems about natural number ordering *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 114
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>Fixpoint leq0n {n} : 0 &lt;= n :=
  match n as n return 0 &lt;= n with
    | 0 =&gt; tt
    | n'.+1 =&gt; @leq0n n'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 118
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>

Fixpoint subnn {n} : n - n =n 0 :=
  match n as n return n - n =n 0 with
    | 0 =&gt; tt
    | n'.+1 =&gt; @subnn n'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance leq_refl : Reflexive leq
  := @subnn.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 127
Time: 0.05s">
<div class="time" style="width: 33.557046979866%"></div>
<pre>

Fixpoint leq_transd {x y z} : (x &lt;= y -&gt; y &lt;= z -&gt; x &lt;= z)%dprop :=
  match x as x, y as y, z as z return (x &lt;= y -&gt; y &lt;= z -&gt; x &lt;= z)%dprop with
    | 0, 0, 0 =&gt; dprop_istrue
    | x'.+1, 0, 0 =&gt; dprop_istrue
    | 0, y'.+1, 0 =&gt; dprop_istrue
    | 0, 0, z'.+1 =&gt; dprop_istrue
    | x'.+1, y'.+1, 0 =&gt; dprop_istrue
    | x'.+1, 0, z'.+1 =&gt; dprop_istrue
    | 0, y'.+1, z'.+1 =&gt; @leq_transd 0 y' z'
    | x'.+1, y'.+1, z'.+1 =&gt; @leq_transd x' y' z'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 139
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>

Global Instance leq_trans : Transitive (fun n m =&gt; leq n m)
  := @leq_transd.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 142
Time: 0.026s">
<div class="time" style="width: 17.44966442953%"></div>
<pre>

Fixpoint leq_antisymd {x y} : (x &lt;= y -&gt; y &lt;= x -&gt; x =n y)%dprop :=
  match x as x, y as y return (x &lt;= y -&gt; y &lt;= x -&gt; x =n y)%dprop with
    | 0, 0 =&gt; dprop_istrue
    | x'.+1, y'.+1 =&gt; @leq_antisymd x' y'
    | _, _ =&gt; dprop_istrue
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma leq_antisym : forall {x y}, x &lt;= y -&gt; y &lt;= x -&gt; x = y.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y p q.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_nat.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 154
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>
  apply leq_antisymd; assumption.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition not_nltn n : ~ (n &lt; n).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 159
Time: 0.001s">
<div class="time" style="width: 0.67114093959732%"></div>
<pre>
  induction n as [|n IH]; simpl.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply IH.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

