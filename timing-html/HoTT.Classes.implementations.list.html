<html>
<head>
<title>list.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for list.v</h1>

<div class="code" title="File: list.v
Line: 1
Time: 0.451s">
<div class="time" style="width: 100%"></div>
<pre>Require Import
  HoTT.Classes.interfaces.abstract_algebra
  HoTT.Types.Unit HoTT.Types.Prod.</pre>
</div>
<div class="code" title="File: list.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Open Scope list_scope.</pre>
</div>
<div class="code" title="File: list.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Standard notations for lists. 
In a special module to avoid conflicts. *)</pre>
</div>
<div class="code" title="File: list.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module ListNotations.</pre>
</div>
<div class="code" title="File: list.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation " [] " := nil : list_scope.</pre>
</div>
<div class="code" title="File: list.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation " [ x ] " := (cons x nil) : list_scope.</pre>
</div>
<div class="code" title="File: list.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation " [ x ; y ; .. ; z ] " :=  (cons x (cons y .. (cons z nil) ..))
  : list_scope.</pre>
</div>
<div class="code" title="File: list.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End ListNotations.</pre>
</div>
<div class="code" title="File: list.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Import ListNotations.</pre>
</div>
<div class="code" title="File: list.v
Line: 15
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>

Fixpoint length {A} (l : list A) := match l with
  | [] =&gt; O
  | _ :: l =&gt; S (length l)
  end.</pre>
</div>
<div class="code" title="File: list.v
Line: 20
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>

Fixpoint fold_left {A B} (f : A -&gt; B -&gt; A) (acc : A) (l : list B) :=
  match l with
  | [] =&gt; acc
  | x :: l =&gt; fold_left f (f acc x) l
  end.</pre>
</div>
<div class="code" title="File: list.v
Line: 26
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>

Fixpoint map {A B} (f : A -&gt; B) (l : list A) :=
  match l with
  | [] =&gt; []
  | x :: l =&gt; (f x) :: (map f l)
  end.</pre>
</div>
<div class="code" title="File: list.v
Line: 32
Time: 0.004s">
<div class="time" style="width: 0.88691796008869%"></div>
<pre>

Fixpoint map2 `(f : A -&gt; B -&gt; C)
  (def_l : list A -&gt; list C) (def_r : list B -&gt; list C)
  l1 l2 :=
  match l1, l2 with
  | [], [] =&gt; []
  | [], _ =&gt; def_r l2
  | _, [] =&gt; def_l l1
  | x :: l1, y :: l2 =&gt; (f x y) :: (map2 f def_l def_r l1 l2)
  end.</pre>
</div>
<div class="code" title="File: list.v
Line: 42
Time: 0.002s">
<div class="time" style="width: 0.44345898004435%"></div>
<pre>

Lemma map2_cons `(f : A -&gt; B -&gt; C) defl defr x l1 y l2 :
  map2 f defl defr (x::l1) (y::l2) = (f x y) :: map2 f defl defr l1 l2.</pre>
</div>
<div class="code" title="File: list.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: list.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
reflexivity.</pre>
</div>
<div class="code" title="File: list.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: list.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma map_id `(f : A -&gt; A) (Hf : forall x, f x = x) (l : list A) : map f l = l.</pre>
</div>
<div class="code" title="File: list.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: list.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
induction l as [|x l IHl].</pre>
</div>
<div class="code" title="File: list.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: list.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: list.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite Hf,IHl.</pre>
</div>
<div class="code" title="File: list.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: list.v
Line: 54
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: list.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance sg_op_app A : SgOp (list A) := @app A.</pre>
</div>
<div class="code" title="File: list.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance app_assoc A : Associative (@app A).</pre>
</div>
<div class="code" title="File: list.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: list.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
intros l1.</pre>
</div>
<div class="code" title="File: list.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> induction l1 as [|x l1 IH];intros l2 l3.</pre>
</div>
<div class="code" title="File: list.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: list.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl;apply ap;apply IH.</pre>
</div>
<div class="code" title="File: list.v
Line: 63
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: list.v
Line: 64
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>

Fixpoint for_all {A} (P : A -&gt; Type) l : Type :=
  match l with
  | [] =&gt; Unit
  | x :: l =&gt; P x /\ for_all P l
  end.</pre>
</div>
<div class="code" title="File: list.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma for_all_trivial {A} (P : A -&gt; Type) : (forall x, P x) -&gt;
  forall l, for_all P l.</pre>
</div>
<div class="code" title="File: list.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: list.v
Line: 74
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>
intros HP l;induction l as [|x l IHl];split;auto.</pre>
</div>
<div class="code" title="File: list.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: list.v
Line: 76
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>

Lemma for_all_map {A B} P Q (f : A -&gt; B) (Hf : forall x, P x -&gt; Q (f x))
 : forall l, for_all P l -&gt; for_all Q (map f l).</pre>
</div>
<div class="code" title="File: list.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: list.v
Line: 80
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>
intros l;induction l as [|x l IHl];simpl.</pre>
</div>
<div class="code" title="File: list.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> auto.</pre>
</div>
<div class="code" title="File: list.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [Hx Hl].</pre>
</div>
<div class="code" title="File: list.v
Line: 83
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre> split;auto.</pre>
</div>
<div class="code" title="File: list.v
Line: 83
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: list.v
Line: 84
Time: 0.004s">
<div class="time" style="width: 0.88691796008869%"></div>
<pre>

Lemma for_all_map2 {A B C} P Q R
  `(f : A -&gt; B -&gt; C) (Hf : forall x y, P x -&gt; Q y -&gt; R (f x y))
  def_l (Hdefl : forall l1, for_all P l1 -&gt; for_all R (def_l l1))
  def_r (Hdefr : forall l2, for_all Q l2 -&gt; for_all R (def_r l2))
  : forall l1 l2, for_all P l1 -&gt; for_all Q l2 -&gt;
    for_all R (map2 f def_l def_r l1 l2).</pre>
</div>
<div class="code" title="File: list.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: list.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
intros l1;induction l1 as [|x l1 IHl1].</pre>
</div>
<div class="code" title="File: list.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: list.v
Line: 94
Time: 0.003s">
<div class="time" style="width: 0.66518847006652%"></div>
<pre> intros [|y l2] _; auto.</pre>
</div>
<div class="code" title="File: list.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: list.v
Line: 95
Time: 0.009s">
<div class="time" style="width: 1.9955654101996%"></div>
<pre> intros [|y l2] [Hx Hl1];[intros _|intros [Hy Hl2]];simpl;auto.</pre>
</div>
<div class="code" title="File: list.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply Hdefl.</pre>
</div>
<div class="code" title="File: list.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl;auto.</pre>
</div>
<div class="code" title="File: list.v
Line: 96
Time: 0.004s">
<div class="time" style="width: 0.88691796008869%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: list.v
Line: 97
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>

Lemma fold_preserves {A B} P Q (f : A -&gt; B -&gt; A)
  (Hf : forall x y, P x -&gt; Q y -&gt; P (f x y))
  : forall acc (Ha : P acc) l (Hl : for_all Q l), P (fold_left f acc l).</pre>
</div>
<div class="code" title="File: list.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: list.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
intros acc Ha l Hl;revert l Hl acc Ha.</pre>
</div>
<div class="code" title="File: list.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
intros l;induction l as [|x l IHl].</pre>
</div>
<div class="code" title="File: list.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros _ acc Ha.</pre>
</div>
<div class="code" title="File: list.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact Ha.</pre>
</div>
<div class="code" title="File: list.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: list.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [Hx Hl] acc Ha.</pre>
</div>
<div class="code" title="File: list.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply IHl;auto.</pre>
</div>
<div class="code" title="File: list.v
Line: 107
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: list.v
Line: 108
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>

Instance for_all_trunc {A} {n} (P : A -&gt; Type) : forall l,
  for_all (fun x =&gt; IsTrunc n (P x)) l -&gt; IsTrunc n (for_all P l).</pre>
</div>
<div class="code" title="File: list.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: list.v
Line: 112
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre>
intros l;induction l as [|x l IHl];simpl.</pre>
</div>
<div class="code" title="File: list.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros _.</pre>
</div>
<div class="code" title="File: list.v
Line: 114
Time: 0.001s">
<div class="time" style="width: 0.22172949002217%"></div>
<pre> destruct n;apply _.</pre>
</div>
<div class="code" title="File: list.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
-</pre>
</div>
<div class="code" title="File: list.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [Hx Hl].</pre>
</div>
<div class="code" title="File: list.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply IHl in Hl.</pre>
</div>
<div class="code" title="File: list.v
Line: 116
Time: 0.005s">
<div class="time" style="width: 1.1086474501109%"></div>
<pre> apply _.</pre>
</div>
<div class="code" title="File: list.v
Line: 116
Time: 0.002s">
<div class="time" style="width: 0.44345898004435%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: list.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

