<html>
<head>
<title>Fracture.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Fracture.v</h1>

<div class="code" title="File: Fracture.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 1
Time: 0.062s">
<div class="time" style="width: 7.808564231738%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 1
Time: 0.016s">
<div class="time" style="width: 2.0151133501259%"></div>
<pre>
Require Import Fibrations Extensions Pullback NullHomotopy.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 2
Time: 0.633s">
<div class="time" style="width: 79.722921914358%"></div>
<pre>
Require Import Modality Lex Open Closed Nullification.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 3
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>
Require Import HoTT.Tactics.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** * The lex-modal fracture theorem *)

(** The fracture theorem for two modalities [O1] and [O2] and a type [A], when it holds, states that the naturality square

&lt;&lt;
 A   --&gt;   O1 A
 |          |
 |          |
 V          V
O2 A --&gt; O2 (O1 A)
&gt;&gt;

is a pullback.  This says in a certain precise sense that [A] can be recovered from its [O1]- and [O2]-reflections together with some information about how they fit together.  If we think of [O1] and [O2] as subuniverses or subtoposes, then the fracture theorem says that their "union", or more precisely their *gluing*, is the whole universe.

We will prove the fracture theorem holds under the assumptions that [O2] is lex, and that [O1]-connected types are [O2]-modal.  Note that like lex-ness, the latter is also a "large" hypothesis.  But also as with lex-ness, rather than hypothesize it polymorphically with a module type, we just hypothesize it in the obvious way and allow the polymophism of the resulting theorem to be computed automatically.  This actually gives more precise information: the fracture theorem for a particular type [A] only depends on this hypothesis for types [B] lying in the same universe as [A].  (In fact, as we will see, it only needs the special cases of the fibers of [to O1 A], but in examples it seems no harder to verify the general case.)

It may sometimes happen that in addition, the "intersection" of [O1] and [O2] is trivial.  This is naturally expressed in the context of the fracture theorem by saying that [O2]-modal types are [O1]-connected, i.e. the converse of the second hypothesis of our fracture theorem.  When this also holds, we can show that the universe [Type] can actually be reconstructed, up to equivalence, from the universes of [O1]- and [O2]-modal types and the [O2]-reflection from the first to the second, using the "Artin gluing construction" from topos theory.  *)

</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Fracture (Os : Modalities).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 26
Time: 0.064s">
<div class="time" style="width: 8.0604534005038%"></div>
<pre>

  Module Export OsL := Lex_Modalities_Theory Os.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** ** The fracture theorem *)

 </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section FractureTheorem.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context (O1 O2 : Modality).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 33
Time: 0.007s">
<div class="time" style="width: 0.8816120906801%"></div>
<pre>

    Definition fracture_square (A : Type)
    : O_functor O2 (to O1 A) o to O2 A == to O2 (O1 A) o to O1 A
    := to_O_natural O2 (to O1 A).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    
    (** Here are the hypotheses of the fracture theorem *)
   </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context `{Lex O2}.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 40
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>

    Definition Gluable : Type
      := forall (A : Type), IsConnected O1 A -&gt; In O2 A.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context (ino2_isconnectedo1 : Gluable).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The fracture theorem. *)
   </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 47
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>Definition ispullback_fracture_square A
    : IsPullback (fracture_square A).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 49
Time: 0.485s">
<div class="time" style="width: 61.083123425693%"></div>
<pre>
      refine (ispullback_connmap_mapino_commsq O2 _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** And typeclass magic finds everything except the one we need our hypothesis for. *)
     </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 52
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>intros x; refine (ino2_isconnectedo1 _ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 52
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** The fracture gluing theorem *)

    (** We now also assume the converse of the second hyopthesis *)
   </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Disjoint : Type
      := forall (A : Type), In O2 A -&gt; IsConnected O1 A.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context (isconnectedo1_ino2 : Disjoint).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** This implies that the universe decomposes into an [O1]-part, an [O2]-part, and a gluing map.  We define these pieces separately in order to make the maps transparent but the homotopies opaque. *)
   </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 63
Time: 0.004s">
<div class="time" style="width: 0.50377833753149%"></div>
<pre>Definition fracture_glue_uncurried
    : { B : Type_ O1 &amp; { C : Type_ O2 &amp; C -&gt; O2 B }} -&gt; Type
      := fun BCf =&gt; Pullback BCf.2.2 (to O2 BCf.1).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 65
Time: 0.004s">
<div class="time" style="width: 0.50377833753149%"></div>
<pre>

    Definition fracture_glue
      (B C : Type) `{HB: In O1 B} `{HC: In O2 C} (f : C -&gt; O2 B)
    : Type
      := fracture_glue_uncurried ((B;HB);((C;HC);f)).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 70
Time: 0.007s">
<div class="time" style="width: 0.8816120906801%"></div>
<pre>

    Definition fracture_unglue
    : Type -&gt; { B : Type_ O1 &amp; { C : Type_ O2 &amp; C -&gt; O2 B }}
    := fun A =&gt; ((O1 A ; O_inO A) ; ((O2 A ; O_inO A) ; O_functor O2 (to O1 A))).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 74
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>

    Definition fracture_unglue_isretr `{Univalence}
               (BCf : { B : Type_ O1 &amp; { C : Type_ O2 &amp; C -&gt; O2 B }})
    : fracture_unglue (fracture_glue_uncurried BCf) = BCf.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 79
Time: 0.003s">
<div class="time" style="width: 0.37783375314861%"></div>
<pre>
      destruct BCf as [B [C f]]; simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** The first two components of our path will be applications of univalence.  We begin by observing that maps we will use are equivalences. *)
     </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 82
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>assert (IsEquiv (O_rec ((to O2 B)^*' f))).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 83
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre> apply isequiv_O_rec_O_inverts.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 83
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>
        apply O_inverts_conn_map, conn_map_pullback'.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 84
Time: 0.08s">
<div class="time" style="width: 10.07556675063%"></div>
<pre>
        intros ob; apply isconnectedo1_ino2; exact _.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 85
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>
      assert (IsEquiv (O_rec (f^* (to O2 B)))).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 87
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre> apply isequiv_O_rec_O_inverts.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 87
Time: 0.004s">
<div class="time" style="width: 0.50377833753149%"></div>
<pre>
        apply O_inverts_conn_map, conn_map_pullback; exact _.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Now we start building the path. *)
     </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 90
Time: 0.009s">
<div class="time" style="width: 1.1335012594458%"></div>
<pre>refine (path_sigma' _ _ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 91
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre> apply path_TypeO; simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 91
Time: 0.008s">
<div class="time" style="width: 1.007556675063%"></div>
<pre>
        refine (path_universe (O_rec ((to O2 B)^*' f))).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 92
Time: 0.263s">
<div class="time" style="width: 33.123425692695%"></div>
<pre>
      refine (transport_sigma' _ _ @ _); simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 93
Time: 0.009s">
<div class="time" style="width: 1.1335012594458%"></div>
<pre>
      refine (path_sigma' _ _ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 95
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre> apply path_TypeO; simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 95
Time: 0.006s">
<div class="time" style="width: 0.75566750629723%"></div>
<pre>
        refine (path_universe (O_rec (f^* (to O2 B)))).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** It remains to identify the induced function with the given [f].  We begin with some boilerplate. *)
     </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 98
Time: 0.004s">
<div class="time" style="width: 0.50377833753149%"></div>
<pre>apply path_arrow; intros c.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 98
Time: 0.027s">
<div class="time" style="width: 3.4005037783375%"></div>
<pre>
      refine (transport_arrow_toconst _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 99
Time: 0.034s">
<div class="time" style="width: 4.2821158690176%"></div>
<pre>
      refine (transport_arrow_fromconst
                (C := fun X:Type_ O1 =&gt; O2 X) _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 101
Time: 0.029s">
<div class="time" style="width: 3.6523929471033%"></div>
<pre>
      refine (transport_compose O2 (TypeO_pr1 O1) _ _ @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 102
Time: 0.037s">
<div class="time" style="width: 4.6599496221662%"></div>
<pre>
      refine (transport_compose idmap O2 _ _ @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Now we have to compute through the action of [ap] and [transport] on paths in sigmas and the universe.  In applying these it helps to specify a couple of intermediate steps explicitly. *)
     </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 105
Time: 0.134s">
<div class="time" style="width: 16.876574307305%"></div>
<pre>transitivity (transport idmap
                     (ap O2 (path_universe (O_rec ((to O2 B)^*' f))))
                     (O_functor O2 (to O1 (Pullback f (to O2 B)))
                                ((O_rec (f^* (to O2 B)))^-1 c)));
        [ apply ap11; repeat apply ap
        | transitivity (O_functor O2 (O_rec (to O2 B^*' f))
                          (O_functor O2 (to O1 (Pullback f (to O2 B)))
                                     ((O_rec (f^* (to O2 B)))^-1 c))) ].</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 113
Time: 0.2s">
<div class="time" style="width: 25.188916876574%"></div>
<pre> refine (pr1_path_sigma_uncurried _ @ eisretr pr1 _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 114
Time: 0.034s">
<div class="time" style="width: 4.2821158690176%"></div>
<pre> refine (transport_compose idmap (TypeO_pr1 O2)
                  (path_TypeO O2 (O2 (Pullback f (to O2 B)); _) C _)^
                  c @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 116
Time: 0.028s">
<div class="time" style="width: 3.5264483627204%"></div>
<pre>
        refine (ap (fun p =&gt; transport idmap p c) (ap_V _ _) @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 117
Time: 0.209s">
<div class="time" style="width: 26.32241813602%"></div>
<pre>
        refine (ap (fun p =&gt; transport idmap p^ c)
                   (pr1_path_sigma_uncurried _ @ eisretr pr1 _) @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 119
Time: 0.003s">
<div class="time" style="width: 0.37783375314861%"></div>
<pre>
        refine (transport_path_universe_V _ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 121
Time: 0.017s">
<div class="time" style="width: 2.1410579345088%"></div>
<pre> refine (ap (fun p =&gt; transport idmap p _)
                   (ap_O_path_universe O2 _) @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 122
Time: 0.004s">
<div class="time" style="width: 0.50377833753149%"></div>
<pre>
        refine (transport_path_universe _ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Now we're down to the real point. *)
     </pre>
</div>
<div class="code" title="File: Fracture.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>+</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 125
Time: 0.011s">
<div class="time" style="width: 1.3853904282116%"></div>
<pre> refine ((O_functor_compose O2 _ _ _)^ @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 125
Time: 0.008s">
<div class="time" style="width: 1.007556675063%"></div>
<pre>
        refine (O_functor_homotopy O2 _ _ (O_rec_beta _) _ @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 126
Time: 0.011s">
<div class="time" style="width: 1.3853904282116%"></div>
<pre>
        revert c; equiv_intro (O_rec (f^* (to O2 B))) x.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 127
Time: 0.005s">
<div class="time" style="width: 0.62972292191436%"></div>
<pre>
        refine (ap _ (eissect _ _) @ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 128
Time: 0.006s">
<div class="time" style="width: 0.75566750629723%"></div>
<pre>
        revert x; apply O_indpaths; intros x; simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 129
Time: 0.005s">
<div class="time" style="width: 0.62972292191436%"></div>
<pre>
        refine (to_O_natural O2 _ x @ _); simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 130
Time: 0.007s">
<div class="time" style="width: 0.8816120906801%"></div>
<pre>
        refine (_ @ ap f (O_rec_beta _ _)^).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 131
Time: 0.006s">
<div class="time" style="width: 0.75566750629723%"></div>
<pre>
        destruct x as [a [b q]]; simpl; exact (q^).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 132
Time: 0.794s">
<div class="time" style="width: 100%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 133
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>

    Definition fracture_unglue_issect `{Univalence} (A : Type)
    : fracture_glue_uncurried (fracture_unglue A) = A.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_universe_uncurried, equiv_inverse.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 138
Time: 0.003s">
<div class="time" style="width: 0.37783375314861%"></div>
<pre>
      exact (BuildEquiv _ _ (pullback_corec (fracture_square A))
                        (ispullback_fracture_square A)).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 140
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 141
Time: 0.006s">
<div class="time" style="width: 0.75566750629723%"></div>
<pre>

    Definition isequiv_fracture_unglue `{Univalence}
    : IsEquiv fracture_unglue
      := isequiv_adjointify
           fracture_unglue
           fracture_glue_uncurried
           fracture_unglue_isretr
           fracture_unglue_issect.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 149
Time: 0.004s">
<div class="time" style="width: 0.50377833753149%"></div>
<pre>

    Definition equiv_fracture_unglue `{Univalence}
    : Type &lt;~&gt; { B : Type_ O1 &amp; { C : Type_ O2 &amp; C -&gt; O2 B }}
      := BuildEquiv _ _ fracture_unglue isequiv_fracture_unglue.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 153
Time: 0.181s">
<div class="time" style="width: 22.7959697733%"></div>
<pre>

  End FractureTheorem.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Fracture.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** The propositional fracture theorem *)

(** An easy example of the lex-modal fracture theorem is supplied by the open and closed modalities for an hprop [U].  In order to consider these together, we need to build their union as a family of modalities. *)

</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 162
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>Module Open_And_Closed_Modalities
  := Modalities_FamUnion OpenModalities ClosedModalities.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 163
Time: 0.042s">
<div class="time" style="width: 5.2896725440806%"></div>
<pre>
Module Import OpClM := Lex_Modalities_Theory Open_And_Closed_Modalities.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 164
Time: 0.05s">
<div class="time" style="width: 6.2972292191436%"></div>
<pre>
Module Import Propositional_Fracture
  := Fracture Open_And_Closed_Modalities.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 166
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>

Definition gluable_open_closed `{Funext} (U : hProp)
: Gluable (Op U) (Cl U).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  change (Contr (U -&gt; A) -&gt; (U -&gt; Contr A)); intros ? u.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 172
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>
  exists (center (U -&gt; A) u); intros a.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 173
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>
  exact (ap10 (path_contr _ (fun _ =&gt; a)) u).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 174
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 175
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>

Definition disjoint_open_closed `{Funext} (U : hProp)
: Disjoint (Op U) (Cl U).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  change ((U -&gt; Contr A) -&gt; Contr (U -&gt; A)); intros uc.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 181
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>
  exists (fun u =&gt; let i := uc u in center A).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros f; apply path_arrow; intros u.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (uc u); apply path_contr.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 184
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We can also prove the same thing without funext if we use the nullification versions of these modalities. *)

</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 188
Time: 0.005s">
<div class="time" style="width: 0.62972292191436%"></div>
<pre>Import NulM.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 188
Time: 0.058s">
<div class="time" style="width: 7.3047858942065%"></div>
<pre>
Module Import Propositional_Fracture'
  := Fracture Nullification_Modalities.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 190
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>

Definition gluable_open_closed' (U : hProp)
: Gluable (Op' U) (Cl' U).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A ? u; simpl in *.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 195
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>
  pose proof (contr_inhabited_hprop U u).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (Contr A).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 198
Time: 0.137s">
<div class="time" style="width: 17.254408060453%"></div>
<pre> refine (contr_equiv (Op' U A) _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 199
Time: 0.014s">
<div class="time" style="width: 1.7632241813602%"></div>
<pre> refine (O_rec idmap).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 199
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>
      intros []; simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ooextendable_equiv.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 201
Time: 0.003s">
<div class="time" style="width: 0.37783375314861%"></div>
<pre>
      refine (equiv_isequiv (@equiv_contr_contr U Unit _ _)).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 203
Time: 0.005s">
<div class="time" style="width: 0.62972292191436%"></div>
<pre> refine (isequiv_adjointify _ (to (Op' U) A) _ _).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 204
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre> intros a; apply O_rec_beta.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 205
Time: 0.006s">
<div class="time" style="width: 0.75566750629723%"></div>
<pre> intros oa; revert oa; apply O_indpaths; intros a; simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 205
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>
        apply ap, O_rec_beta.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 206
Time: 0.009s">
<div class="time" style="width: 1.1335012594458%"></div>
<pre>       
  apply ooextendable_contr; exact _.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 207
Time: 0.023s">
<div class="time" style="width: 2.896725440806%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 208
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>

Definition disjoint_open_closed' (U : hProp)
: Disjoint (Op' U) (Cl' U).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A An.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply isconnected_from_elim; intros C Cn f.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 214
Time: 0.002s">
<div class="time" style="width: 0.25188916876574%"></div>
<pre>
  refine (@local_rec _ C Cn tt _ tt ; _); simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros u.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (f (@local_rec _ A An u Empty_rec tt)).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a; simpl.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 218
Time: 0.004s">
<div class="time" style="width: 0.50377833753149%"></div>
<pre>
    refine (@local_indpaths _ C Cn tt (fun _ =&gt; f a) _ _ tt);
      intros u; simpl in *.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 220
Time: 0.004s">
<div class="time" style="width: 0.50377833753149%"></div>
<pre>
    refine (_ @ (@local_rec_beta _ C Cn tt _ u)^).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 222
Time: 0.001s">
<div class="time" style="width: 0.12594458438287%"></div>
<pre>
    exact (@local_indpaths _ A An u (fun _ =&gt; a) _ (Empty_ind _) tt).</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 223
Time: 0.012s">
<div class="time" style="width: 1.5113350125945%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fracture.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

