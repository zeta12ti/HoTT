<html>
<head>
<title>Peano.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Peano.v</h1>

<div class="code" title="File: Peano.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(************************************************************************)
(*  v      *   The Coq Proof Assistant  /  The Coq Development Team     *)
(* &lt;O___,, *   INRIA - CNRS - LIX - LRI - PPS - Copyright 1999-2012     *)
(*   \VV/  **************************************************************)
(*    //   *      This file is distributed under the terms of the       *)
(*         *       GNU Lesser General Public License Version 2.1        *)
(************************************************************************)

(** The type [nat] of Peano natural numbers (built from [O] and [S])
    is defined in [Datatypes.v] *)

(** This module defines the following operations on natural numbers :
    - predecessor [pred]
    - addition [plus]
    - multiplication [mult]
    - less or equal order [le]
    - less [lt]
    - greater or equal [ge]
    - greater [gt]

   It states various lemmas and theorems about natural numbers,
   including Peano's axioms of arithmetic (in Coq, these are provable).
   Case analysis on [nat] and induction on [nat * nat] are provided too
 *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Require Import Notations.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 25
Time: 0.002s">
<div class="time" style="width: 50%"></div>
<pre>
Require Import Datatypes.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope identity_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Logic_Type.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition eq_S := f_equal S.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Resolve (f_equal S): v62.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Resolve (f_equal (A:=nat)): core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The predecessor function *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition pred (n:nat) : nat := match n with
                                 | O =&gt; n
                                 | S u =&gt; u
                                 end.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(* Hint Resolve (f_equal pred): v62. *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem pred_Sn : forall n:nat, n = pred (S n).</pre>
</div>
<div class="code" title="File: Peano.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  simpl; reflexivity.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Injectivity of successor *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 49
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>Definition eq_add_S n m (H: S n = S m): n = m := f_equal pred H.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Immediate eq_add_S: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem not_eq_S : forall n m:nat, n &lt;&gt; m -&gt; S n &lt;&gt; S m.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  red; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Resolve not_eq_S: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition IsSucc (n:nat) : Type :=
  match n with
  | O =&gt; False
  | S p =&gt; True
  end.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Zero is not the successor of a number *)

(* XXX Andrej: Try to put back in, does not work with current Coq. *)
(* Theorem O_S : forall n:nat, 0 &lt;&gt; S n. *)
(* Proof. *)
(*   discriminate. *)
(* Qed. *)
(* Hint Resolve O_S: core. *)

(* XXX Andrej: Try to put back in, does not work with current Coq. *)
(* Theorem n_Sn : forall n:nat, n &lt;&gt; S n. *)
(* Proof. *)
(*   induction n; auto. *)
(* Qed. *)
(* Hint Resolve n_Sn: core. *)

(** addition *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint plus (n m:nat) : nat :=
  match n with
  | O =&gt; m
  | S p =&gt; S (p + m)
  end

where "n + m" := (plus n m) : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Resolve (f_equal2 plus): v62.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Resolve (f_equal2 (A1:=nat) (A2:=nat)): core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma plus_n_O : forall n:nat, n = n + 0.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 93
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>
  induction n; simpl; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Resolve plus_n_O: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma plus_O_n : forall n:nat, 0 + n = n.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma plus_n_Sm : forall n m:nat, S (n + m) = n + S m.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 104
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>
  intros n m; induction n; simpl; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Resolve plus_n_Sm: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma plus_Sn_m : forall n m:nat, S n + m = S (n + m).</pre>
</div>
<div class="code" title="File: Peano.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Standard associated names *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation plus_0_r_reverse := plus_n_O (compat "8.2").</pre>
</div>
<div class="code" title="File: Peano.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation plus_succ_r_reverse := plus_n_Sm (compat "8.2").</pre>
</div>
<div class="code" title="File: Peano.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Multiplication *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint mult (n m:nat) : nat :=
  match n with
  | O =&gt; 0
  | S p =&gt; m + p * m
  end

where "n * m" := (mult n m) : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Resolve (f_equal2 mult): core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma mult_n_O : forall n:nat, 0 = n * 0.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n; simpl; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Resolve mult_n_O: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma mult_n_Sm : forall n m:nat, n * m + n = n * S m.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 136
Time: 0.002s">
<div class="time" style="width: 50%"></div>
<pre>
  intros; induction n as [| p H]; simpl; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 137
Time: 0.002s">
<div class="time" style="width: 50%"></div>
<pre>
  destruct H; rewrite &lt;- plus_n_Sm; apply eq_S.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 138
Time: 0.002s">
<div class="time" style="width: 50%"></div>
<pre>
  pattern m at 1 3; elim m; simpl; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 139
Time: 0.002s">
<div class="time" style="width: 50%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Resolve mult_n_Sm: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Standard associated names *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation mult_0_r_reverse := mult_n_O (compat "8.2").</pre>
</div>
<div class="code" title="File: Peano.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation mult_succ_r_reverse := mult_n_Sm (compat "8.2").</pre>
</div>
<div class="code" title="File: Peano.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Truncated subtraction: [m-n] is [0] if [n&gt;=m] *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint minus (n m:nat) : nat :=
  match n, m with
  | O, _ =&gt; n
  | S k, O =&gt; n
  | S k, S l =&gt; k - l
  end

where "n - m" := (minus n m) : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Definition of the usual orders, the basic properties of [le] and [lt]
    can be found in files Le and Lt *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 159
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>Inductive le (n:nat) : nat -&gt; Type :=
  | le_n : n &lt;= n
  | le_S : forall m:nat, n &lt;= m -&gt; n &lt;= S m

where "n &lt;= m" := (le n m) : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Constructors le: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(*i equivalent to : "Hints Resolve le_n le_S : core." i*)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition lt (n m:nat) := S n &lt;= m.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Unfold lt: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "&lt;" := lt : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition ge (n m:nat) := m &lt;= n.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Unfold ge: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "&gt;=" := ge : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition gt (n m:nat) := m &lt; n.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Unfold gt: core.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "&gt;" := gt : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Notation "x &lt;= y &lt;= z" := (x &lt;= y /\ y &lt;= z) : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "x &lt;= y &lt; z" := (x &lt;= y /\ y &lt; z) : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "x &lt; y &lt; z" := (x &lt; y /\ y &lt; z) : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "x &lt; y &lt;= z" := (x &lt; y /\ y &lt;= z) : nat_scope.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem le_pred : forall n m, n &lt;= m -&gt; pred n &lt;= pred m.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
induction 1; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 189
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre> destruct m; simpl; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem le_S_n : forall n m, S n &lt;= S m -&gt; n &lt;= m.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
intros n m.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (le_pred (S n) (S m)).</pre>
</div>
<div class="code" title="File: Peano.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Case analysis *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem nat_case :
 forall (n:nat) (P:nat -&gt; Type), P 0 -&gt; (forall m:nat, P (S m)) -&gt; P n.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 199
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Principle of double induction *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem nat_double_ind :
 forall R:nat -&gt; nat -&gt; Type,
   (forall n:nat, R 0 n) -&gt;
   (forall n:nat, R (S n) 0) -&gt;
   (forall n m:nat, R n m -&gt; R (S n) (S m)) -&gt; forall n m:nat, R n m.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 210
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>
  induction n; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 211
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>
  destruct m; auto.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Maximum and minimum : definitions and specifications *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 216
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>Fixpoint max n m : nat :=
  match n, m with
    | O, _ =&gt; m
    | S n', O =&gt; n
    | S n', S m' =&gt; S (max n' m')
  end.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint min n m : nat :=
  match n, m with
    | O, _ =&gt; 0
    | S n', O =&gt; 0
    | S n', S m' =&gt; S (min n' m')
  end.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Theorem max_l : forall n m : nat, m &lt;= n -&gt; max n m = n. *)
(* Proof. *)
(* induction n; destruct m; simpl; auto. inversion 1. *)
(* intros. apply f_equal. apply IHn. apply le_S_n. trivial. *)
(* Qed. *)

(* Theorem max_r : forall n m : nat, n &lt;= m -&gt; max n m = m. *)
(* Proof. *)
(* induction n; destruct m; simpl; auto. inversion 1. *)
(* intros. apply f_equal. apply IHn. apply le_S_n. trivial. *)
(* Qed. *)

(* Theorem min_l : forall n m : nat, n &lt;= m -&gt; min n m = n. *)
(* Proof. *)
(* induction n; destruct m; simpl; auto. inversion 1. *)
(* intros. apply f_equal. apply IHn. apply le_S_n. trivial. *)
(* Qed. *)

(* Theorem min_r : forall n m : nat, m &lt;= n -&gt; min n m = m. *)
(* Proof. *)
(* induction n; destruct m; simpl; auto. inversion 1. *)
(* intros. apply f_equal. apply IHn. apply le_S_n. trivial. *)
(* Qed. *)

(** [n]th iteration of the function [f] *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint nat_iter (n:nat) {A} (f:A-&gt;A) (x:A) : A :=
  match n with
    | O =&gt; x
    | S n' =&gt; f (nat_iter n' f x)
  end.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 259
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma nat_iter_succ_r n {A} (f:A-&gt;A) (x:A) :
  nat_iter (S n) f x = nat_iter n f (f x).</pre>
</div>
<div class="code" title="File: Peano.v
Line: 262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 263
Time: 0.003s">
<div class="time" style="width: 75%"></div>
<pre>
  induction n; intros; simpl; rewrite &lt;- ?IHn; trivial.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 264
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 265
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>

Theorem nat_iter_plus :
  forall (n m:nat) {A} (f:A -&gt; A) (x:A),
    nat_iter (n + m) f x = nat_iter n f (nat_iter m f x).</pre>
</div>
<div class="code" title="File: Peano.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 270
Time: 0.004s">
<div class="time" style="width: 100%"></div>
<pre>
  induction n; intros; simpl; rewrite ?IHn; trivial.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 271
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Preservation of invariants : if [f : A-&gt;A] preserves the invariant [Inv],
    then the iterates of [f] also preserve it. *)

</pre>
</div>
<div class="code" title="File: Peano.v
Line: 276
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem nat_iter_invariant :
  forall (n:nat) {A} (f:A -&gt; A) (P : A -&gt; Type),
    (forall x, P x -&gt; P (f x)) -&gt;
    forall x, P x -&gt; P (nat_iter n f x).</pre>
</div>
<div class="code" title="File: Peano.v
Line: 279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 280
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>
  induction n; simpl; trivial.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A f P Hf x Hx.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply Hf, IHn; trivial.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 282
Time: 0.001s">
<div class="time" style="width: 25%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Peano.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

