<html>
<head>
<title>UnivalenceImpliesFunext.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for UnivalenceImpliesFunext.v</h1>

<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 1
Time: 0.041s">
<div class="time" style="width: 100%"></div>
<pre>Require Import HoTT.Basics Types.Universe Types.Paths Types.Unit.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Generalizable All Variables.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Univalence Implies Functional Extensionality *)

(** Here we prove that univalence implies function extensionality. *)

(** We define an axiom-free variant of [Univalence] *)</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 9
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Definition Univalence_type := forall (A B : Type), IsEquiv (equiv_path A B).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section UnivalenceImpliesFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{ua : Univalence_type}.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Exponentiation preserves equivalences, i.e., if [e] is an equivalence then so is post-composition by [e]. *)

  (* Should this go somewhere else? *)

 </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 18
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Theorem univalence_isequiv_postcompose `{H0 : IsEquiv A B w} C : IsEquiv (@compose C A B w).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold Univalence_type in *.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 20
Time: 0.022s">
<div class="time" style="width: 53.658536585366%"></div>
<pre>
    refine (isequiv_adjointify
              (@compose C A B w)
              (@compose C B A w^-1)%equiv
              _
              _);
    intro;
    pose (BuildEquiv _ _ w _) as w';
    change H0 with (@equiv_isequiv _ _ w');
    change w with (@equiv_fun _ _ w');
    clearbody w'; clear H0 w;
    rewrite &lt;- (@eisretr _ _ (@equiv_path A B) (ua A B) w');
    generalize ((@equiv_inv _ _ (equiv_path A B) (ua A B)) w')%equiv;
    intro p;
    clear w';
    destruct p;
    reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 36
Time: 0.007s">
<div class="time" style="width: 17.073170731707%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We are ready to prove functional extensionality, starting with the naive non-dependent version. *)

 </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 41
Time: 0.003s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>Local Instance isequiv_src_compose A B
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (compose (fst o pr1)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply @univalence_isequiv_postcompose.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 46
Time: 0.02s">
<div class="time" style="width: 48.780487804878%"></div>
<pre>
    refine (isequiv_adjointify
              (fst o pr1) (fun x =&gt; ((x, x); idpath))
              (fun _ =&gt; idpath)
              _);
      let p := fresh in
      intros [[? ?] p];
        simpl in p; destruct p;
        reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 54
Time: 0.009s">
<div class="time" style="width: 21.951219512195%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 55
Time: 0.003s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>


  Local Instance isequiv_tgt_compose A B
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (compose (snd o pr1)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply @univalence_isequiv_postcompose.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 63
Time: 0.019s">
<div class="time" style="width: 46.341463414634%"></div>
<pre>
    refine (isequiv_adjointify
              (snd o pr1) (fun x =&gt; ((x, x); idpath))
              (fun _ =&gt; idpath)
              _);
      let p := fresh in
      intros [[? ?] p];
        simpl in p; destruct p;
        reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 71
Time: 0.008s">
<div class="time" style="width: 19.512195121951%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Univalence_implies_FunextNondep (A B : Type)
  : forall f g : A -&gt; B, f == g -&gt; f = g.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros f g p.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** Consider the following maps. *)
   </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 79
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>pose (d := fun x : A =&gt; existT (fun xy =&gt; fst xy = snd xy) (f x, f x) (idpath (f x))).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 79
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    pose (e := fun x : A =&gt; existT (fun xy =&gt; fst xy = snd xy) (f x, g x) (p x)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** If we compose [d] and [e] with [free_path_target], we get [f] and [g], respectively. So, if we had a path from [d] to [e], we would get one from [f] to [g]. *)
   </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 82
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>change f with ((snd o pr1) o d).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 82
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    change g with ((snd o pr1) o e).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 83
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    apply ap.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** Since composition with [src] is an equivalence, we can freely compose with [src]. *)
   </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 86
Time: 0.003s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>pose (fun A B x y=&gt; @equiv_inv _ _ _ (@isequiv_ap _ _ _ (@isequiv_src_compose A B) x y)) as H'.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 86
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    apply H'.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 88
Time: 0.007s">
<div class="time" style="width: 17.073170731707%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 89
Time: 0.008s">
<div class="time" style="width: 19.512195121951%"></div>
<pre>
End UnivalenceImpliesFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section UnivalenceImpliesWeakFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{ua1 : Univalence_type, ua2 : Univalence_type}.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Now we use this to prove weak funext, which as we know implies (with dependent eta) also the strong dependent funext. *)

 </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem Univalence_implies_WeakFunext : WeakFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A P allcontr.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** We are going to replace [P] with something simpler. *)
   </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>pose (U := (fun (_ : A) =&gt; Unit)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assert (p : P = U).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply (@Univalence_implies_FunextNondep ua2).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro x.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (@equiv_inv _ _ _ (ua1 _ _)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_contr_unit.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (** Now this is much easier. *)
     </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>rewrite p.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold U; simpl.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exists (fun _ =&gt; tt).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro f.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (@Univalence_implies_FunextNondep ua2).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro x.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 112
Time: 0.002s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>
      destruct (@contr Unit _ (f x)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 114
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 115
Time: 0.001s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
End UnivalenceImpliesWeakFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 116
Time: 0.002s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>

Definition Univalence_type_implies_Funext_type `{ua1 : Univalence_type, ua2 : Univalence_type} : Funext_type
  := WeakFunext_implies_Funext (@Univalence_implies_WeakFunext ua1 ua2).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** As justified by the above proof, we may assume [Univalence -&gt; Funext]. *)</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance Univalence_implies_Funext `{Univalence} : Funext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Admitted.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

