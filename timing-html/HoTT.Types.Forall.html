<html>
<head>
<title>Forall.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Forall.v</h1>

<div class="code" title="File: Forall.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)
(** * Theorems about dependent products *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 3
Time: 0.019s">
<div class="time" style="width: 82.608695652174%"></div>
<pre>Require Import HoTT.Basics.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 3
Time: 0.004s">
<div class="time" style="width: 17.391304347826%"></div>
<pre>
Require Import Types.Paths.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


Generalizable Variables A B C f g e n.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section AssumeFunext.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Context `{Funext}.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Paths *)

(** Paths [p : f = g] in a function type [forall x:X, P x] are equivalent to functions taking values in path types, [H : forall x:X, f x = g x], or concisely, [H : f == g].

This equivalence, however, is just the combination of [apD10] and function extensionality [funext], and as such, [path_forall], et seq. are given in the [Overture]:  *)

(** Now we show how these things compute. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 21
Time: 0.004s">
<div class="time" style="width: 17.391304347826%"></div>
<pre>Definition apD10_path_forall `{P : A -&gt; Type}
  (f g : forall x, P x) (h : f == g)
  : apD10 (path_forall _ _ h) == h
  := apD10 (eisretr apD10 h).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 24
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>

Definition eta_path_forall `{P : A -&gt; Type}
  (f g : forall x, P x) (p : f = g)
  : path_forall _ _ (apD10 p) = p
  := eissect apD10 p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 29
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>

Definition path_forall_1 `{P : A -&gt; Type} (f : forall x, P x)
  : (path_forall f f (fun x =&gt; 1)) = 1
  := eta_path_forall f f 1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The identification of the path space of a dependent function space, up to equivalence, is of course just funext. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 36
Time: 0.006s">
<div class="time" style="width: 26.086956521739%"></div>
<pre>Definition equiv_apD10 `{Funext} {A : Type} (P : A -&gt; Type) f g
: (f = g) &lt;~&gt; (f == g)
  := BuildEquiv _ _ (@apD10 A P f g) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 38
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>

Global Instance isequiv_path_forall `{P : A -&gt; Type} (f g : forall x, P x)
  : IsEquiv (path_forall f g) | 0
  := @isequiv_inverse _ _ (@apD10 A P f g) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 42
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>

Definition equiv_path_forall `{P : A -&gt; Type} (f g : forall x, P x)
  : (f == g)  &lt;~&gt;  (f = g)
  := BuildEquiv _ _ (path_forall f g) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Arguments equiv_path_forall {A%type_scope P} (f g)%function_scope.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Path algebra *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 51
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>Definition path_forall_pp `{P : A -&gt; Type} (f g h : forall x, P x)
           (p : f == g) (q : g == h)
: path_forall f h (fun x =&gt; p x @ q x) = path_forall f g p @ path_forall g h q.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert p q.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 55
Time: 0.005s">
<div class="time" style="width: 21.739130434783%"></div>
<pre>
  equiv_intro (@apD10 A P f g) p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 56
Time: 0.005s">
<div class="time" style="width: 21.739130434783%"></div>
<pre>
  equiv_intro (@apD10 A P g h) q.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 57
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
  transitivity (path_forall f h (apD10 (p @ q))).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 59
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre> apply ap, path_forall; intros x.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 59
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
    symmetry; apply apD10_pp.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (eta_path_forall _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 61
Time: 0.004s">
<div class="time" style="width: 17.391304347826%"></div>
<pre>
    apply concat2; symmetry; apply eta_path_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 62
Time: 0.005s">
<div class="time" style="width: 21.739130434783%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 63
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>


Definition path_forall_V `{P : A -&gt; Type} (f g : forall x, P x)
           (p : f == g)
  : path_forall _ _ (fun x =&gt; (p x)^) = (path_forall _ _ p)^.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 69
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
  transitivity (path_forall _ _ (fun x =&gt; (apD10 (path_forall _ _ p) x)^)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 70
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
  f_ap.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 71
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 71
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre> apply (@ap _ _ (fun h x =&gt; (h x)^)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 71
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre> apply eisretr.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 71
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
  transitivity (path_forall _ _ (apD10 (path_forall _ _ p)^)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 72
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
  apply ap, inverse.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall; intros x.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 73
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre> apply apD10_V.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply eissect.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 74
Time: 0.005s">
<div class="time" style="width: 21.739130434783%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Transport *)

(** The concrete description of transport in sigmas and pis is rather trickier than in the other types. In particular, these cannot be described just in terms of transport in simpler types; they require the full Id-elim rule by way of "dependent transport" [transportD].

  In particular this indicates why "transport" alone cannot be fully defined by induction on the structure of types, although Id-elim/transportD can be (cf. Observational Type Theory). A more thorough set of lemmas, along the lines of the present ones but dealing with Id-elim rather than just transport, might be nice to have eventually? *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 81
Time: 0.01s">
<div class="time" style="width: 43.478260869565%"></div>
<pre>Definition transport_forall
  {A : Type} {P : A -&gt; Type} {C : forall x, P x -&gt; Type}
  {x1 x2 : A} (p : x1 = x2) (f : forall y : P x1, C x1 y)
  : (transport (fun x =&gt; forall y : P x, C x y) p f)
    == (fun y =&gt;
       transport (C x2) (transport_pV _ _ _) (transportD _ _ p _ (f (p^ # y))))
  := match p with idpath =&gt; fun _ =&gt; 1 end.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A special case of [transport_forall] where the type [P] does not depend on [A],
    and so it is just a fixed type [B]. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 90
Time: 0.003s">
<div class="time" style="width: 13.04347826087%"></div>
<pre>Definition transport_forall_constant
  {A B : Type} {C : A -&gt; B -&gt; Type}
  {x1 x2 : A} (p : x1 = x2) (f : forall y : B, C x1 y)
  : (transport (fun x =&gt; forall y : B, C x y) p f)
    == (fun y =&gt; transport (fun x =&gt; C x y) p (f y))
  := match p with idpath =&gt; fun _ =&gt; 1 end.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 95
Time: 0.008s">
<div class="time" style="width: 34.782608695652%"></div>
<pre>

Definition apD_transport_forall_constant
  {A B : Type} (C : A -&gt; B -&gt; Type)
  {x1 x2 : A} (p : x1 = x2) (f : forall y : B, C x1 y)
  {y1 y2 : B} (q : y1 = y2)
: apD (transport (fun x =&gt; forall y : B, C x y) p f) q
  = ap (transport (C x2) q) (transport_forall_constant p f y1)
    @ transport_transport C p q (f y1)
    @ ap (transport (fun x : A =&gt; C x y2) p) (apD f q)
    @ (transport_forall_constant p f y2)^.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 106
Time: 0.007s">
<div class="time" style="width: 30.434782608696%"></div>
<pre>
  destruct p, q; reflexivity.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 107
Time: 0.007s">
<div class="time" style="width: 30.434782608696%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Maps on paths *)

(** The action of maps given by application. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 112
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>Definition ap_apply_lD {A} {B : A -&gt; Type} {f g : forall x, B x} (p : f = g) (z : A)
  : ap (fun f =&gt; f z) p = apD10 p z
:= 1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 114
Time: 0.003s">
<div class="time" style="width: 13.04347826087%"></div>
<pre>

Definition ap_apply_lD2 {A} {B : A -&gt; Type} { C : forall x, B x -&gt; Type}
           {f g : forall x y, C x y} (p : f = g) (z1 : A) (z2 : B z1)
  : ap (fun f =&gt; f z1 z2) p = apD10 (apD10 p z1) z2.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 119
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
    by path_induction.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 120
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** The action of maps given by lambda. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 124
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>Definition ap_lambdaD {A B : Type} {C : B -&gt; Type} {x y : A} (p : x = y) (M : forall a b, C b) :
  ap (fun a b =&gt; M a b) p =
  path_forall _ _ (fun b =&gt; ap (fun a =&gt; M a b) p).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 127
Time: 0.003s">
<div class="time" style="width: 13.04347826087%"></div>
<pre>
  destruct p;
  symmetry;
  simpl; apply path_forall_1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 130
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Dependent paths *)

(** Usually, a dependent path over [p:x1=x2] in [P:A-&gt;Type] between [y1:P x1] and [y2:P x2] is a path [transport P p y1 = y2] in [P x2].  However, when [P] is a function space, these dependent paths have a more convenient description: rather than transporting the argument of [y1] forwards and backwards, we transport only forwards but on both sides of the equation, yielding a "naturality square". *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 136
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>Definition dpath_forall
  {A:Type} (B:A -&gt; Type) (C:forall a, B a -&gt; Type) (x1 x2:A) (p:x1=x2)
  (f:forall y1:B x1, C x1 y1) (g:forall (y2:B x2), C x2 y2)
  : (forall (y1:B x1), transportD B C p y1 (f y1) = g (transport B p y1))
  &lt;~&gt;
  (transport (fun x =&gt; forall y:B x, C x y) p f = g).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 142
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
  destruct p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply equiv_path_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 144
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 145
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>

Definition dpath_forall_constant
  {A B:Type} (C : A -&gt; B -&gt; Type) (x1 x2:A) (p:x1=x2)
  (f:forall (y1:B), C x1 y1) (g:forall (y2:B), C x2 y2)
  : (forall (y1:B), transport (fun x =&gt; C x y1) p (f y1) = g y1)
  &lt;~&gt;
  (transport (fun x =&gt; forall y:B, C x y) p f = g).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply equiv_path_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Functorial action *)

(** The functoriality of [forall] is slightly subtle: it is contravariant in the domain type and covariant in the codomain, but the codomain is dependent on the domain. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition functor_forall `{P : A -&gt; Type} `{Q : B -&gt; Type}
    (f0 : B -&gt; A) (f1 : forall b:B, P (f0 b) -&gt; Q b)
  : (forall a:A, P a) -&gt; (forall b:B, Q b)
  := (fun g b =&gt; f1 _ (g (f0 b))).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 163
Time: 0.003s">
<div class="time" style="width: 13.04347826087%"></div>
<pre>

Definition ap_functor_forall `{P : A -&gt; Type} `{Q : B -&gt; Type}
    (f0 : B -&gt; A) (f1 : forall b:B, P (f0 b) -&gt; Q b)
    (g g' : forall a:A, P a) (h : g == g')
  : ap (functor_forall f0 f1) (path_forall _ _ h)
    = path_forall _ _ (fun b:B =&gt; (ap (f1 b) (h (f0 b)))).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 171
Time: 0.005s">
<div class="time" style="width: 21.739130434783%"></div>
<pre>  equiv_intro (@apD10 A P g g') h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 171
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
  destruct h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  simpl.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 172
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
  transitivity (idpath (functor_forall f0 f1 g)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 174
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre> exact (ap (ap (functor_forall f0 f1)) (path_forall_1 g)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 175
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  apply path_forall_1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 175
Time: 0.005s">
<div class="time" style="width: 21.739130434783%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 176
Time: 0.004s">
<div class="time" style="width: 17.391304347826%"></div>
<pre>

Definition functor_forall_compose
           `{P : A -&gt; Type} `{Q : B -&gt; Type} `{R : C -&gt; Type}
           (f0 : B -&gt; A) (f1 : forall b:B, P (f0 b) -&gt; Q b)
           (g0 : C -&gt; B) (g1 : forall c:C, Q (g0 c) -&gt; R c)
           (k : forall a, P a)
  : functor_forall g0 g1 (functor_forall f0 f1 k) == functor_forall (f0 o g0) (fun c =&gt; g1 c o f1 (g0 c)) k
  := fun a =&gt; 1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Equivalences *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 187
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>Global Instance isequiv_functor_forall `{P : A -&gt; Type} `{Q : B -&gt; Type}
  `{IsEquiv B A f} `{forall b, @IsEquiv (P (f b)) (Q b) (g b)}
  : IsEquiv (functor_forall f g) | 1000.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 190
Time: 0.003s">
<div class="time" style="width: 13.04347826087%"></div>
<pre>
  simple refine (isequiv_adjointify (functor_forall f g)
    (functor_forall (f^-1)
      (fun (x:A) (y:Q (f^-1 x)) =&gt; eisretr f x # (g (f^-1 x))^-1 y
      )) _ _);
  try assumption; (* https://coq.inria.fr/bugs/show_bug.cgi?id=3848 *)
  intros h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 197
Time: 0.013s">
<div class="time" style="width: 56.521739130435%"></div>
<pre> abstract (
        apply path_forall; intros b; unfold functor_forall;
        rewrite eisadj;
        rewrite &lt;- transport_compose;
        rewrite ap_transport;
        rewrite eisretr;
        apply apD
      ).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 205
Time: 0.007s">
<div class="time" style="width: 30.434782608696%"></div>
<pre> abstract (
        apply path_forall; intros a; unfold functor_forall;
        rewrite eissect;
        apply apD
      ).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 209
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 210
Time: 0.006s">
<div class="time" style="width: 26.086956521739%"></div>
<pre>

Definition equiv_functor_forall `{P : A -&gt; Type} `{Q : B -&gt; Type}
  (f : B -&gt; A) `{IsEquiv B A f}
  (g : forall b, P (f b) -&gt; Q b)
  `{forall b, @IsEquiv (P (f b)) (Q b) (g b)}
  : (forall a, P a) &lt;~&gt; (forall b, Q b)
  := BuildEquiv _ _ (functor_forall f g) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 217
Time: 0.007s">
<div class="time" style="width: 30.434782608696%"></div>
<pre>

Definition equiv_functor_forall' `{P : A -&gt; Type} `{Q : B -&gt; Type}
  (f : B &lt;~&gt; A) (g : forall b, P (f b) &lt;~&gt; Q b)
  : (forall a, P a) &lt;~&gt; (forall b, Q b)
  := equiv_functor_forall f g.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 222
Time: 0.006s">
<div class="time" style="width: 26.086956521739%"></div>
<pre>

Definition equiv_functor_forall_id `{P : A -&gt; Type} `{Q : A -&gt; Type}
  (g : forall a, P a &lt;~&gt; Q a)
  : (forall a, P a) &lt;~&gt; (forall a, Q a)
  := equiv_functor_forall (equiv_idmap A) g.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 227
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>

Definition equiv_functor_forall_pb {A B : Type} {P : A -&gt; Type}
  (f : B &lt;~&gt; A)
  : (forall a, P a) &lt;~&gt; (forall b, P (f b))
  := equiv_functor_forall' (Q := P o f) f (fun b =&gt; equiv_idmap).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 232
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>

Definition equiv_functor_forall_pf {A B : Type} {Q : B -&gt; Type}
  (f : B &lt;~&gt; A)
  : (forall a, (Q (f^-1 a))) &lt;~&gt; (forall b, Q b).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 237
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
  srefine (equiv_functor_forall' (P := Q o f^-1) f _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros b; exact (equiv_transport Q _ _ (eissect f b)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 240
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** There is another way to make forall functorial that acts on on equivalences only. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 243
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>Definition equiv_functor_forall_covariant
           `{P : A -&gt; Type} `{Q : B -&gt; Type}
           (f : A &lt;~&gt; B) (g : forall a, P a &lt;~&gt; Q (f a))
  : (forall a, P a) &lt;~&gt; (forall b, Q b).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 247
Time: 0.004s">
<div class="time" style="width: 17.391304347826%"></div>
<pre>
  refine (equiv_adjointify
           (fun (k:forall a, P a) b =&gt; eisretr f b # (g (f^-1 b) (k (f^-1 b))))
           (fun h a =&gt; (g a)^-1 (h (f a)))
           _ _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros h; apply path_forall; intros b.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 252
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
    refine (_ @ apD h (eisretr f b)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 253
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
    apply ap, eisretr.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros k; apply path_forall; intros a.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 255
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
    refine (_ @ apD k (eissect f a)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 257
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
    refine (_ @ (ap_transport (eissect f a) g (k (f^-1 (f a))))^).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 258
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
    refine (_ @ (transport_compose Q f (eissect f a) _)^).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 259
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
    refine (ap (fun p =&gt; transport Q p _) (eisadj f a)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 260
Time: 0.007s">
<div class="time" style="width: 30.434782608696%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 261
Time: 0.005s">
<div class="time" style="width: 21.739130434783%"></div>
<pre>

Definition equiv_functor_forall_covariant_compose
           `{P : A -&gt; Type} `{Q : B -&gt; Type} `{R : C -&gt; Type}
           (f0 : A &lt;~&gt; B) (f1 : forall a, P a &lt;~&gt; Q (f0 a))
           (g0 : B &lt;~&gt; C) (g1 : forall b, Q b &lt;~&gt; R (g0 b))
           (h : forall a, P a) (c : C)
  : equiv_functor_forall_covariant g0 g1 (equiv_functor_forall_covariant f0 f1 h) c
    = equiv_functor_forall_covariant (g0 oE f0) (fun a =&gt; g1 (f0 a) oE f1 a) h c.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 270
Time: 0.014s">
<div class="time" style="width: 60.869565217391%"></div>
<pre>
  cbn.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 271
Time: 0.003s">
<div class="time" style="width: 13.04347826087%"></div>
<pre>
  rewrite (ap_transport _ g1 _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 272
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
  rewrite (transport_compose R g0 _ _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 273
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
  symmetry; apply transport_pp.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 274
Time: 0.008s">
<div class="time" style="width: 34.782608695652%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Truncatedness: any dependent product of n-types is an n-type *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance contr_forall `{P : A -&gt; Type} `{forall a, Contr (P a)}
  : Contr (forall a, P a) | 100.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (fun a =&gt; center (P a)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro f.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  apply path_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  intro a.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 282
Time: 0.023s">
<div class="time" style="width: 100%"></div>
<pre>  apply contr.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance trunc_forall `{P : A -&gt; Type} `{forall a, IsTrunc n (P a)}
  : IsTrunc n (forall a, P a) | 100.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  generalize dependent P.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  simple_induction n n IH; simpl; intros P ?.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* case [n = -2], i.e. contractibility *)
 </pre>
</div>
<div class="code" title="File: Forall.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Forall.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* case n = n'.+1 *)
 </pre>
</div>
<div class="code" title="File: Forall.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Forall.v
Line: 293
Time: 0.007s">
<div class="time" style="width: 30.434782608696%"></div>
<pre> intros f g; apply (trunc_equiv _ (apD10 ^-1)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 293
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Contractibility: A product over a contractible type is equivalent to the fiber over the center. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_contr_forall `{Contr A} `(P : A -&gt; Type)
: (forall a, P a) &lt;~&gt; P (center A).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  simple refine (equiv_adjointify (fun (f:forall a, P a) =&gt; f (center A)) _ _ _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros p a; exact (transport P (path_contr _ _) p).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (transport2 P (q := 1) _ p).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 303
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
    apply path_contr.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f; apply path_forall; intros a.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply apD.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 306
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 307
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Symmetry of curried arguments *)

(** Using the standard Haskell name for this, as itâ€™s a handy utility function.

Note: not sure if [P] will usually be deducible, or whether it would be better explicit. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition flip `{P : A -&gt; B -&gt; Type}
  : (forall a b, P a b) -&gt; (forall b a, P a b)
  := fun f b a =&gt; f a b.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance isequiv_flip `{P : A -&gt; B -&gt; Type}
  : IsEquiv (@flip _ _ P) | 0.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (flip_P := @flip _ _ P).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (flip_P_inv := @flip _ _ (flip P)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (flip_P_is_sect := (fun f =&gt; 1) : Sect flip_P flip_P_inv).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (flip_P_is_retr := (fun g =&gt; 1) : Sect flip_P_inv flip_P).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 323
Time: 0.001s">
<div class="time" style="width: 4.3478260869565%"></div>
<pre>
  exists flip_P_inv flip_P_is_retr flip_P_is_sect.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro g.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  exact 1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 325
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 326
Time: 0.002s">
<div class="time" style="width: 8.695652173913%"></div>
<pre>

Definition equiv_flip `(P : A -&gt; B -&gt; Type)
  : (forall a b, P a b) &lt;~&gt; (forall b a, P a b)
  := BuildEquiv _ _ (@flip _ _ P) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 330
Time: 0.019s">
<div class="time" style="width: 82.608695652174%"></div>
<pre>

End AssumeFunext.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

