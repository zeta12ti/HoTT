<html>
<head>
<title>ObjectClassifier.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ObjectClassifier.v</h1>

<div class="code" title="File: ObjectClassifier.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** We prove that Fam and Pow are equivalent.
This equivalence is close to the existence of an object classifier.
*)

</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 4
Time: 0.02s">
<div class="time" style="width: 100%"></div>
<pre>Require Import HoTT.Basics.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 4
Time: 0.018s">
<div class="time" style="width: 90%"></div>
<pre>
Require Import Types.Universe Types.Sigma Types.Arrow.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 5
Time: 0.017s">
<div class="time" style="width: 85%"></div>
<pre>
Require Import Fibrations HProp EquivalenceVarieties UnivalenceImpliesFunext Pullback.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section AssumeUnivalence.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Context `{ua:Univalence}.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section FamPow.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** We consider Families and Powers over a fixed type [A] *)</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Variable A : Type.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition Fam A:=sigT (fun I:Type  =&gt; I-&gt;A).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 15
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Definition p2f: (A-&gt;Type)-&gt; Fam A:=  fun Q:(A-&gt;Type) =&gt; ( (sigT Q) ; @pr1 _ _).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 16
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Definition f2p: Fam A -&gt; (A-&gt;Type):=
 fun F =&gt; let (I, f) := F in (fun a =&gt; (hfiber f a)).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* This is generalized in Functorish.v *)</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 20
Time: 0.004s">
<div class="time" style="width: 20%"></div>
<pre>Theorem transport_exp (U V:Type)(w:U&lt;~&gt;V): forall (f:U-&gt;A),
  (transport (fun I:Type =&gt; I-&gt;A) (path_universe w) f) = (f o w^-1).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros f; apply path_arrow; intros y.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 23
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  refine (transport_arrow_toconst _ _ _ @ _).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply ap.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 25
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  by apply transport_path_universe_V.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 26
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem FamequivPow : (A-&gt;Type)&lt;~&gt;(Fam A).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
apply (equiv_adjointify p2f f2p).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(* Theorem right (F:Fam A) : F = (p2ff2p F) *)

</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>+</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 33
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>intros [I f].</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 33
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre> set (e:=equiv_path_sigma _ (@existT Type (fun I0 : Type =&gt; I0 -&gt; A) I f)
  ({a : A &amp; hfiber f a} ; @pr1 _ _)).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl in e.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 34
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
  enough (X:{p : I = {a : A &amp; @hfiber I A f a} &amp;
     @transport _ (fun I0 : Type =&gt; I0 -&gt; A) _ _ p f = @pr1 _ _}) by apply (e X)^.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 36
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  set (w:=@equiv_fibration_replacement A I f).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 37
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
  exists (path_universe w).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 38
Time: 0.013s">
<div class="time" style="width: 65%"></div>
<pre> 
  transitivity (f o w^-1);[apply transport_exp|apply path_forall;by (intros [a [i p]])].</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
 (* Theorem left (P:A -&gt; Type) : (f2pp2f P) = P *)

</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>+</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro P.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 41
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre> by_extensionality a.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 41
Time: 0.004s">
<div class="time" style="width: 20%"></div>
<pre>
 apply ((path_universe (@hfiber_fibration  _ a P))^).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 42
Time: 0.009s">
<div class="time" style="width: 45%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We construct the universal diagram for the object classifier *)</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 45
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>Definition topmap {B} (f:B-&gt;A) (b:B): pType :=
  Build_pType (hfiber f (f b)) (b ; idpath (f b)).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 46
Time: 0.004s">
<div class="time" style="width: 20%"></div>
<pre>

Local Definition help_objclasspb_is_fibrantreplacement (P:A-&gt; Type): (sigT P)-&gt;
  (Pullback P (@pr1 _ (fun u :Type =&gt; u))):=
(fun (X : {a : A &amp; P a}) =&gt; (fun (a : A) (q : P a) =&gt; (a; ((P a; q); 1))) X.1 X.2).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 50
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>

Local Definition help_objclasspb_is_fibrantreplacement2 (P:A-&gt; Type):
 (Pullback P (@pr1 _ (fun u :Type =&gt; u))) -&gt; (sigT P).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 53
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
intros [a [[T t] p]].</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (a;(transport (fun X =&gt; X) (p^) t)).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 54
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 55
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>

Lemma objclasspb_is_fibrantreplacement (P:A-&gt; Type): (sigT P) &lt;~&gt; (Pullback P (@pr1 _ (fun u :Type =&gt; u))).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 58
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
exists (help_objclasspb_is_fibrantreplacement P).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
apply isequiv_biinv.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 60
Time: 0.006s">
<div class="time" style="width: 30%"></div>
<pre> split; exists (help_objclasspb_is_fibrantreplacement2 P); intros [a p].</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply idpath.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 60
Time: 0.005s">
<div class="time" style="width: 25%"></div>
<pre>
destruct p as [[T t] p].</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 61
Time: 0.01s">
<div class="time" style="width: 50%"></div>
<pre>
refine (path_sigma' _ (idpath a) _).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
simpl in p.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 63
Time: 0.015s">
<div class="time" style="width: 75%"></div>
<pre> by path_induction.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 63
Time: 0.02s">
<div class="time" style="width: 100%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 64
Time: 0.004s">
<div class="time" style="width: 20%"></div>
<pre>

End FamPow.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Subobjectclassifier.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** We prove that hProp is the subobject classifier *)
(** In fact, the proof works for general mere predicates on [Type], 
not just [IsHProp], truncations and modalities are important examples.*)</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Variable A : Type.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Variable isP : Type -&gt; Type.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Variable ishprop_isP : forall I, IsHProp (isP I).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition IsPfibered {I} (f:I-&gt;A):=forall i, isP (hfiber f i).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 74
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Definition PFam := (sig (fun F:Fam A =&gt; IsPfibered (pr2 F))).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(* Bug: abstract should accept more than one tactic.
https://coq.inria.fr/bugs/show_bug.cgi?id=3609
Alternatively, we would like to use [Program] here.
6a99db1c31fe267fdef7be755fa169fb6a87e3cf
Instead we split the [Definition] and first make a [Local Definition] *)</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 80
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>Local Definition pow2Pfam_pf (P:forall a:A, {X :Type &amp; isP X}): 
           IsPfibered (pr2 (p2f A (pr1 o P))).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
Proof.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
intro i.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 83
Time: 0.004s">
<div class="time" style="width: 20%"></div>
<pre> 
rewrite &lt;- (path_universe_uncurried (@hfiber_fibration A i (pr1 o P))).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
apply ((P i).2).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 85
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 86
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>

Definition pow2Pfam (P:forall a:A, {X :Type &amp; isP X}): PFam:=
  (p2f A (fun a =&gt; (pr1 (P a))); pow2Pfam_pf P).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Definition Pfam2pow_pf (F:PFam)(a:A):isP (f2p A F.1 a).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
unfold f2p.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 92
Time: 0.004s">
<div class="time" style="width: 20%"></div>
<pre> by destruct F as [[I f] p].</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 93
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>

Definition Pfam2pow (F:PFam) (a:A): {X :Type &amp; isP X}:=
   ((f2p A F.1 a); (Pfam2pow_pf F a)).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem PowisoPFam : (forall a:A, {X :Type &amp; isP X})&lt;~&gt;PFam.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 99
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
apply (equiv_adjointify pow2Pfam Pfam2pow).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
 +</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 101
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre> intros [[B f] q].</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 101
Time: 0.018s">
<div class="time" style="width: 90%"></div>
<pre> apply path_sigma_hprop.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 101
Time: 0.014s">
<div class="time" style="width: 70%"></div>
<pre>
  refine (@eisretr _ _ (FamequivPow A) _ (B;f)).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
+</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro P.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro a.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 103
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
 assert (f2p A (p2f A (pr1 o P)) a = (pr1 (P a))).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 104
Time: 0.008s">
<div class="time" style="width: 40%"></div>
<pre>
  set (p:=@eissect _ _ (FamequivPow A) _).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 105
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
  apply (ap10 (p (pr1 o P)) a).</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 106
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
by apply path_sigma_hprop.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 107
Time: 0.008s">
<div class="time" style="width: 40%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 108
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
End Subobjectclassifier.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 109
Time: 0.012s">
<div class="time" style="width: 60%"></div>
<pre>

End AssumeUnivalence.</pre>
</div>
<div class="code" title="File: ObjectClassifier.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

